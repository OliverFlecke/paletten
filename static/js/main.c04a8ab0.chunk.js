(this["webpackJsonptemperature-website"]=this["webpackJsonptemperature-website"]||[]).push([[0],{121:function(e,t){},122:function(e,t){},124:function(e,t){},126:function(e,t){},135:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n(1),a=n.n(r),s=n(61),i=n.n(s),u=(n(70),n(31)),l=n(30),o=n(8),d=n.n(o),f=n(19),b=n(6),j=n(62),h=function(e){var t=e.color,n=e.children,r=e.className,a=e.onClick;return Object(c.jsx)("button",{onClick:a,className:"text-white p-2 m-2 text-xl rounded ".concat(m(null!==t&&void 0!==t?t:"blue")," ").concat(r),children:n})};function m(e){switch(e){case"blue":return"bg-blue-900";case"red":return"bg-red-900";case"green":return"bg-green-900";default:return"bg-gray-700"}}var p,x=function(e){var t=e.client,n=Object(r.useState)(0),a=Object(b.a)(n,2),s=a[0],i=a[1],u=Object(r.useCallback)((function(e){var n=e.currentTarget.valueAsNumber;i(n),t.publish("temperature/set",n.toString(),{retain:!0})}),[t,i]),l=Object(r.useState)(!1),o=Object(b.a)(l,2),d=o[0],f=o[1],j=Object(r.useCallback)((function(e){var n=e.currentTarget.checked;f(n),t.publish("temperature/auto",n.toString(),{retain:!0})}),[t,f]);return Object(r.useEffect)((function(){t.on("message",(function(e,t){"temperature/set"===e?i(Number(t.toString())):"temperature/auto"===e&&f("true"===t.toString())})),t.subscribe("temperature/set"),t.subscribe("temperature/auto")}),[t,i]),Object(c.jsxs)("div",{className:"w-full",children:[Object(c.jsxs)("div",{className:"space-x-2 h-full",children:[Object(c.jsx)("span",{className:"h-full align-middle",children:"Automatisk temperaturkontrol?"}),Object(c.jsx)("input",{type:"checkbox",onChange:j,checked:d,className:"w-6 h-6 align-middle"})]}),Object(c.jsxs)("div",{hidden:!d,children:[Object(c.jsx)("input",{className:"w-11/12",type:"range",min:"0",max:"25",value:s,onChange:u}),Object(c.jsxs)("div",{children:["\xd8nskede temperature: ",s," \xb0C"]})]})]})},O=n(63);!function(e){e[e.On=0]="On",e[e.Off=1]="Off"}(p||(p={}));var v=function e(t,n,c){var r=this;Object(O.a)(this,e),this.client=void 0,this.id=void 0,this.name=void 0,this.state=void 0,this.toggle=function(){return r.client.publish(r.commandPath(),"toggle")},this.setState=function(e){return r.client.publish(r.commandPath(),e)},this.commandPath=function(){return"shellies/shelly1-".concat(r.id,"/relay/0/command")},this.id=t,this.name=n,this.client=c},g=function(e){var t=e.state,n=e.name;return Object(c.jsxs)("div",{className:"w-full max-w-xs",children:[Object(c.jsx)("h3",{className:"text-xl",children:n}),Object(c.jsxs)("div",{className:"flex justify-between w-full",children:["Temperatur: ",Object(c.jsxs)("span",{children:[t.temperature," \xb0C"]})]}),Object(c.jsxs)("div",{className:"flex justify-between w-full",children:["Fugtighed:",Object(c.jsxs)("span",{children:[t.humidity," %"]})]})]})},w=n(64),y=function(e){var t=e.shelly;return Object(c.jsxs)(h,{className:"space-x-4",onClick:t.toggle,color:W(t.state),children:[Object(c.jsx)("span",{className:"inline-flex flex-col h-full justify-center align-middle",children:Object(c.jsx)(w.a,{size:"20px"})}),Object(c.jsxs)("span",{children:[t.name," - ",t.state===p.On?"T\xe6ndt":"Slukket"]})]})},k="wss://palletten.northeurope.azurecontainer.io:8083",N=[{id:"C4402D",name:"Spisebord"},{id:"C431FB",name:"Sofa"},{id:"10DB9C",name:"Sovev\xe6relse"}],S={qos:1};var C=function(){var e=Object(r.useState)(),t=Object(b.a)(e,2),n=t[0],a=t[1];return Object(r.useEffect)((function(){function e(){return(e=Object(f.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=a,e.next=3,Object(j.connectAsync)(k);case 3:e.t1=e.sent,(0,e.t0)(e.t1);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),n?Object(c.jsx)(E,{client:n}):Object(c.jsx)("div",{className:"text-black dark:text-white w-full text-center text-xl",children:"Connecting..."})},E=function(e){var t=e.client,n=z(),a=Object(b.a)(n,2),s=a[0],i=a[1],o=z(),j=Object(b.a)(o,2),m=j[0],O=j[1],w=Object(r.useState)((function(){return N.map((function(e){return new v(e.id,e.name,t)}))})),k=Object(b.a)(w,2),S=k[0],C=k[1];Object(r.useEffect)((function(){function e(){return(e=Object(f.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:T(t,S.map((function(e){return e.id})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}t.on("message",(function(e,t){if(e.startsWith("temperature/"))switch(A(e)){case"inside":null===i||void 0===i||i.setTemperature(Number(t));break;case"outside":null===O||void 0===O||O.setTemperature(Number(t))}else if(e.startsWith("humidity/"))switch(A(e)){case"inside":i.setHumidity(Number(t));break;case"outside":O.setHumidity(Number(t))}if(e.startsWith("shellies")){var n=e.match(Object(l.a)(/\x2D([0-9A-Z_a-z]*)/,{id:1}));if(null===n||void 0===n?void 0:n.groups){var c="on"===t.toString()?p.On:p.Off,r=null===n||void 0===n?void 0:n.groups.id;C((function(e){return e.map((function(e){return Object(u.a)(Object(u.a)({},e),{},{state:e.id===r?c:e.state})}))}))}}})),function(t){e.apply(this,arguments)}(t)}),[t]);var E=Object(r.useCallback)((function(){return S.forEach((function(e){return e.setState("on")}))}),[S]),W=Object(r.useCallback)((function(){return S.forEach((function(e){return e.setState("off")}))}),[S]);return Object(c.jsxs)("div",{className:"flex flex-col justify-center items-center text-center mx-4 text-black dark:text-gray-500",children:[Object(c.jsx)("h1",{className:"text-4xl pt-2",children:"Palletten"}),Object(c.jsxs)("div",{className:"flex justify-between space-x-6 pb-4 max-w-lg w-full",children:[Object(c.jsx)(g,{name:"Inde",state:s}),Object(c.jsx)(g,{name:"Ude",state:m})]}),Object(c.jsx)("div",{className:"w-full flex flex-col justify-center align-middle",children:S.map((function(e){return Object(c.jsx)(y,{shelly:e},e.id)}))}),Object(c.jsx)("hr",{className:"w-full my-4"}),Object(c.jsxs)("div",{className:"w-full flex flex-col justify-center align-middle",children:[Object(c.jsx)(h,{onClick:E,children:"T\xe6nd alt"}),Object(c.jsx)(h,{onClick:W,children:"Sluk alt"})]}),Object(c.jsx)("hr",{className:"w-full my-4"}),Object(c.jsx)(x,{client:t})]})};function T(e,t){t.forEach(function(){var t=Object(f.a)(d.a.mark((function t(n){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.subscribe("shellies/shelly1-".concat(n,"/relay/0"),S);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),["inside","outside"].forEach(function(){var t=Object(f.a)(d.a.mark((function t(n){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.subscribe("temperature/".concat(n),S);case 2:return t.next=4,e.subscribe("humidity/".concat(n),S);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}function A(e){var t=e.match(Object(l.a)(/\/([0-9A-Z_a-z]+)$/,{place:1}));return(null===t||void 0===t?void 0:t.groups)?null===t||void 0===t?void 0:t.groups.place:void 0}function W(e){switch(e){case p.Off:return"red";case p.On:return"green";default:return"grey"}}function z(){var e=Object(r.useState)(),t=Object(b.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(),s=Object(b.a)(a,2);return[{temperature:n,humidity:s[0]},{setTemperature:c,setHumidity:s[1]}]}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(Object(c.jsx)(a.a.StrictMode,{children:Object(c.jsx)(C,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},70:function(e,t,n){},76:function(e,t){},78:function(e,t){},94:function(e,t){},96:function(e,t){}},[[135,1,2]]]);
//# sourceMappingURL=main.c04a8ab0.chunk.js.map
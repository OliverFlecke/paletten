(this["webpackJsonptemperature-website"]=this["webpackJsonptemperature-website"]||[]).push([[0],{123:function(e,t){},124:function(e,t){},126:function(e,t){},128:function(e,t){},137:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n(1),a=n.n(r),s=n(30),i=(n(73),n(32)),u=n(31),l=n(8),o=n.n(l),d=n(19),f=n(6),b=n(65),h=function(e){var t=e.color,n=e.children,r=e.className,a=e.onClick;return Object(c.jsx)("button",{onClick:a,className:"text-white p-2 m-2 text-xl rounded ".concat(j(null!==t&&void 0!==t?t:"blue")," ").concat(r),children:n})};function j(e){switch(e){case"blue":return"bg-blue-900";case"red":return"bg-red-900";case"green":return"bg-green-900";default:return"bg-gray-700"}}var m,x=function(e){var t=e.client,n=Object(r.useState)(0),a=Object(f.a)(n,2),s=a[0],i=a[1],u=Object(r.useCallback)((function(e){var n=e.currentTarget.valueAsNumber;i(n),t.publish("temperature/set",n.toString(),{retain:!0})}),[t,i]),l=Object(r.useState)(!1),o=Object(f.a)(l,2),d=o[0],b=o[1],h=Object(r.useCallback)((function(e){var n=e.currentTarget.checked;b(n),t.publish("temperature/auto",n.toString(),{retain:!0})}),[t,b]);return Object(r.useEffect)((function(){t.on("message",(function(e,t){"temperature/set"===e?i(Number(t.toString())):"temperature/auto"===e&&b("true"===t.toString())})),t.subscribe("temperature/set"),t.subscribe("temperature/auto")}),[t,i]),Object(c.jsxs)("div",{className:"w-full",children:[Object(c.jsxs)("div",{className:"space-x-2 h-full",children:[Object(c.jsx)("span",{className:"h-full align-middle",children:"Automatisk temperaturkontrol?"}),Object(c.jsx)("input",{type:"checkbox",onChange:h,checked:d,className:"w-6 h-6 align-middle"})]}),Object(c.jsxs)("div",{hidden:!d,children:[Object(c.jsx)("input",{className:"w-11/12",type:"range",min:"0",max:"25",value:s,onChange:u}),Object(c.jsxs)("div",{children:["\xd8nskede temperature: ",s," \xb0C"]})]})]})},p=n(66);!function(e){e[e.On=0]="On",e[e.Off=1]="Off"}(m||(m={}));var O=function e(t,n,c){var r=this;Object(p.a)(this,e),this.client=void 0,this.id=void 0,this.name=void 0,this.state=void 0,this.toggle=function(){return r.client.publish(r.commandPath(),"toggle")},this.setState=function(e){return r.client.publish(r.commandPath(),e)},this.commandPath=function(){return"shellies/shelly1-".concat(r.id,"/relay/0/command")},this.id=t,this.name=n,this.client=c},v=function(e){var t=e.state,n=e.name;return Object(c.jsxs)("div",{className:"w-full max-w-xs",children:[Object(c.jsx)("h3",{className:"text-xl",children:n}),Object(c.jsxs)("div",{className:"flex justify-between w-full",children:["Temperatur: ",Object(c.jsxs)("span",{children:[t.temperature," \xb0C"]})]}),Object(c.jsxs)("div",{className:"flex justify-between w-full",children:["Fugtighed:",Object(c.jsxs)("span",{children:[t.humidity," %"]})]})]})},w=n(67),g=function(e){var t=e.shelly;return Object(c.jsxs)(h,{className:"space-x-4",onClick:t.toggle,color:A(t.state),children:[Object(c.jsx)("span",{className:"inline-flex flex-col h-full justify-center align-middle",children:Object(c.jsx)(w.a,{size:"20px"})}),Object(c.jsxs)("span",{children:[t.name," - ",t.state===m.On?"T\xe6ndt":"Slukket"]})]})},y="wss://palletten.oliverflecke.me:9001",k=[{id:"C4402D",name:"Spisebord"},{id:"C431FB",name:"Sofa"},{id:"10DB9C",name:"Sovev\xe6relse"}],N={qos:1};var S=function(){var e=Object(r.useState)(),t=Object(f.a)(e,2),n=t[0],a=t[1];return Object(r.useEffect)((function(){function e(){return(e=Object(d.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(b.connectAsync)(y,void 0,!1);case 3:t=e.sent,a(t),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.warn(e.t0),a(null);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),void 0===n?Object(c.jsx)("h2",{className:"text-black dark:text-white w-full text-center text-xl",children:"Connecting..."}):null===n?Object(c.jsx)("h2",{className:"text-black dark:text-white w-full text-center text-xl",children:"Failed to connect. Please contact website developer"}):Object(c.jsx)(C,{client:n})},C=function(e){var t=e.client,n=P(),a=Object(f.a)(n,2),s=a[0],l=a[1],b=P(),j=Object(f.a)(b,2),p=j[0],w=j[1],y=Object(r.useState)((function(){return k.map((function(e){return new O(e.id,e.name,t)}))})),N=Object(f.a)(y,2),S=N[0],C=N[1];Object(r.useEffect)((function(){function e(){return(e=Object(d.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:E(t,S.map((function(e){return e.id})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}t.on("message",(function(e,t){if(e.startsWith("temperature/"))switch(T(e)){case"inside":null===l||void 0===l||l.setTemperature(Number(t));break;case"outside":null===w||void 0===w||w.setTemperature(Number(t))}else if(e.startsWith("humidity/"))switch(T(e)){case"inside":l.setHumidity(Number(t));break;case"outside":w.setHumidity(Number(t))}if(e.startsWith("shellies")){var n=e.match(Object(u.a)(/\x2D([0-9A-Z_a-z]*)/,{id:1}));if(null===n||void 0===n?void 0:n.groups){var c="on"===t.toString()?m.On:m.Off,r=null===n||void 0===n?void 0:n.groups.id;C((function(e){return e.map((function(e){return Object(i.a)(Object(i.a)({},e),{},{state:e.id===r?c:e.state})}))}))}}})),function(t){e.apply(this,arguments)}(t)}),[t]);var A=Object(r.useCallback)((function(){return S.forEach((function(e){return e.setState("on")}))}),[S]),W=Object(r.useCallback)((function(){return S.forEach((function(e){return e.setState("off")}))}),[S]);return Object(c.jsxs)("div",{className:"flex flex-col justify-center items-center text-center mx-4 text-black dark:text-gray-500",children:[Object(c.jsx)("h1",{className:"text-4xl pt-2",children:"Palletten"}),Object(c.jsxs)("div",{className:"flex justify-between space-x-6 pb-4 max-w-lg w-full",children:[Object(c.jsx)(v,{name:"Inde",state:s}),Object(c.jsx)(v,{name:"Ude",state:p})]}),Object(c.jsx)("div",{className:"w-full flex flex-col justify-center align-middle",children:S.map((function(e){return Object(c.jsx)(g,{shelly:e},e.id)}))}),Object(c.jsx)("hr",{className:"w-full my-4"}),Object(c.jsxs)("div",{className:"w-full flex flex-col justify-center align-middle",children:[Object(c.jsx)(h,{onClick:A,children:"T\xe6nd alt"}),Object(c.jsx)(h,{onClick:W,children:"Sluk alt"})]}),Object(c.jsx)("hr",{className:"w-full my-4"}),Object(c.jsx)(x,{client:t})]})};function E(e,t){t.forEach(function(){var t=Object(d.a)(o.a.mark((function t(n){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.subscribe("shellies/shelly1-".concat(n,"/relay/0"),N);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),["inside","outside"].forEach(function(){var t=Object(d.a)(o.a.mark((function t(n){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.subscribe("temperature/".concat(n),N);case 2:return t.next=4,e.subscribe("humidity/".concat(n),N);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}function T(e){var t=e.match(Object(u.a)(/\/([0-9A-Z_a-z]+)$/,{place:1}));return(null===t||void 0===t?void 0:t.groups)?null===t||void 0===t?void 0:t.groups.place:void 0}function A(e){switch(e){case m.Off:return"red";case m.On:return"green";default:return"grey"}}function P(){var e=Object(r.useState)(),t=Object(f.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(),s=Object(f.a)(a,2);return[{temperature:n,humidity:s[0]},{setTemperature:c,setHumidity:s[1]}]}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var W=document.getElementById("root"),B=Object(c.jsx)(a.a.StrictMode,{children:Object(c.jsx)(S,{})});(null===W||void 0===W?void 0:W.hasChildNodes())?Object(s.hydrate)(B,W):Object(s.render)(B,W),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},73:function(e,t,n){},79:function(e,t){},81:function(e,t){},97:function(e,t){},99:function(e,t){}},[[137,1,2]]]);
//# sourceMappingURL=main.ad12a3d1.chunk.js.map
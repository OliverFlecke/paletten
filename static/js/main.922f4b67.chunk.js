(this["webpackJsonptemperature-website"]=this["webpackJsonptemperature-website"]||[]).push([[0],{112:function(e,t,n){},118:function(e,t){},120:function(e,t){},136:function(e,t){},138:function(e,t){},162:function(e,t){},163:function(e,t){},165:function(e,t){},167:function(e,t){},227:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n(1),a=n.n(c),i=n(50),s=(n(112),n(21)),u=n(51),o=n(10),l=n.n(o),d=n(28),b=n(8),j=n(96),f=n(11),h=n.n(f),m=[h.a.rose,h.a.indigo,h.a.teal,h.a.lime,h.a.purple,h.a.cyan,h.a.red,h.a.amber],p=function(){return Object(r.jsx)("h1",{className:"text-4xl pt-2",children:"Paletten".split("").map((function(e,t){return Object(r.jsx)("span",{style:{color:m[t][500]},children:e},t)}))})},O=function(e){var t=e.client,n=Object(c.useState)(0),a=Object(b.a)(n,2),i=a[0],s=a[1],u=Object(c.useCallback)((function(e){var n=e.currentTarget.valueAsNumber;s(n),t.publish("temperature/set",n.toString(),{retain:!0})}),[t,s]),o=Object(c.useState)(!1),l=Object(b.a)(o,2),d=l[0],j=l[1],f=Object(c.useCallback)((function(e){var n=e.currentTarget.checked;j(n),t.publish("temperature/auto",n.toString(),{retain:!0})}),[t,j]);return Object(c.useEffect)((function(){t.on("message",(function(e,t){"temperature/set"===e?s(Number(t.toString())):"temperature/auto"===e&&j("true"===t.toString())})),t.subscribe("temperature/set"),t.subscribe("temperature/auto")}),[t,s]),Object(r.jsxs)("div",{className:"w-full",children:[Object(r.jsxs)("div",{className:"space-x-2 h-full",children:[Object(r.jsx)("label",{htmlFor:"temperature-control",className:"h-full align-middle text-xl",children:"Automatisk temperaturkontrol?"}),Object(r.jsx)("input",{id:"temperature-control",type:"checkbox",onChange:f,checked:d,className:"w-6 h-6 align-middle"})]}),Object(r.jsxs)("div",{hidden:!d,className:"pt-4",children:[Object(r.jsx)("input",{id:"temperature-range",className:"w-11/12 bg-transparent slider-progress",style:{"--min":0,"--max":25,"--value":i},type:"range",min:"0",max:"25",value:i,onChange:u}),Object(r.jsxs)("label",{htmlFor:"temperature-range",children:["\xd8nskede temperature: ",i," \xb0C"]})]})]})},x=function(e){var t=e.color,n=e.children,c=e.className,a=e.onClick;return Object(r.jsx)("button",{onClick:a,className:"text-white p-2 m-2 text-xl rounded ".concat(v(null!==t&&void 0!==t?t:"blue")," ").concat(c),children:n})};function v(e){switch(e){case"blue":return"bg-blue-900";case"red":return"bg-red-900";case"green":return"bg-green-900";default:return"bg-gray-700"}}var g,w=function(e){var t=e.shellies,n=Object(c.useCallback)((function(){return t.forEach((function(e){return e.setState("on")}))}),[t]),a=Object(c.useCallback)((function(){return t.forEach((function(e){return e.setState("off")}))}),[t]);return Object(r.jsxs)("div",{className:"w-full flex flex-row",children:[Object(r.jsx)(x,{onClick:n,className:"flex-grow",children:"T\xe6nd alt"}),Object(r.jsx)(x,{onClick:a,className:"flex-grow",children:"Sluk alt"})]})},y=function(e){var t=e.state,n=e.name;return Object(r.jsxs)("div",{className:"w-full max-w-xs",children:[Object(r.jsx)("h2",{className:"text-xl",children:n}),Object(r.jsxs)("div",{className:"flex justify-between w-full",children:["Temperatur: ",Object(r.jsxs)("span",{children:[t.temperature," \xb0C"]})]}),Object(r.jsxs)("div",{className:"flex justify-between w-full",children:["Fugtighed:",Object(r.jsxs)("span",{children:[t.humidity," %"]})]})]})},k=n(101),N=n(97);!function(e){e[e.On=0]="On",e[e.Off=1]="Off"}(g||(g={}));var S=function e(t,n,r){var c=this;Object(N.a)(this,e),this.client=void 0,this.id=void 0,this.name=void 0,this.state=void 0,this.toggle=function(){return c.client.publish(c.commandPath(),"toggle")},this.setState=function(e){return c.client.publish(c.commandPath(),e)},this.commandPath=function(){return"shellies/shelly1-".concat(c.id,"/relay/0/command")},this.id=t,this.name=n,this.client=r},C=function(e){var t=e.shelly;return Object(r.jsxs)(x,{className:"space-x-4",onClick:t.toggle,color:G(t.state),children:[Object(r.jsx)("span",{className:"inline-flex flex-col h-full justify-center align-middle",children:Object(r.jsx)(k.a,{size:"20px"})}),Object(r.jsxs)("span",{children:[t.name," - ",t.state===g.On?"T\xe6ndt":"Slukket"]})]})},F=n(241);function T(e){return function(e){return e.reduce((function(e,t){return e+t}),0)}(e)/e.length}var M=n(52),E=n(238),H=n(239),A=n(236),P=n(235),W=n(242),z=n(240),B=n(237),D=h.a.purple[500],J=function(e){var t=e.data;return Object(r.jsx)(P.a,{children:function(e){var n=e.width,c=30,a=n-c-20,i=150-20-20,s=function(e){return e.time},u=function(e){return e.temp},o=Object(W.a)({range:[c,a],round:!0,domain:t.map(s),padding:.4}),l=Object(z.a)({range:[i,0],round:!0,domain:[Math.min.apply(Math,Object(M.a)(t.map(u)))-2,Math.max.apply(Math,Object(M.a)(t.map(u)))]}),d=function(e,t){return function(n){return e(t(n))}},b=d(o,s),j=d(l,u);return Object(r.jsxs)("svg",{width:n,height:150,children:[t.map((function(e,t){var n=i-j(e);return Object(r.jsx)(A.a,{children:Object(r.jsx)(B.a,{x:b(e),y:i-n,height:n,width:o.bandwidth(),fill:h.a.red[700]})},"bar-".concat(t))})),Object(r.jsx)(E.a,{top:i+10,scale:o,tickFormat:function(e){return"".concat(e.getHours())},stroke:D,tickStroke:D,tickLabelProps:function(){return{fill:D,fontSize:11,textAnchor:"middle"}}}),Object(r.jsx)(H.a,{scale:l,left:c+10,numTicks:5,tickFormat:function(e){return"".concat(e," C")},stroke:D,tickStroke:D,tickLabelProps:function(){return{fill:D,fontSize:11,textAnchor:"end"}}})]})}})},I=function(e){var t=e.client,n=Object(c.useState)(),a=Object(b.a)(n,2),i=a[0],s=a[1],u=Object(c.useState)(),o=Object(b.a)(u,2),l=o[0],d=o[1];return Object(c.useEffect)((function(){t.on("message",(function(e,t){e.startsWith("history")&&("history/inside"===e?s(L(t)):"history/outside"===e&&d(L(t)))})),t.subscribe("history/heater/#"),t.subscribe("history/+")}),[t]),Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("h2",{children:"Temperature inside"}),i&&Object(r.jsx)(J,{data:i}),Object(r.jsx)("h2",{children:"Temperature outside"}),l&&Object(r.jsx)(J,{data:l})]})};function L(e){var t,n=JSON.parse(e.toString()).map((function(e){return Object(s.a)(Object(s.a)({},e),{},{time:Object(F.a)(e.time,"yyyy-MM-dd HH:mm:ss",0)})})),r=(t=function(e){return t=e.time,"".concat(t.getFullYear(),"-").concat(t.getMonth(),"-").concat(t.getDate()," ").concat(t.getHours());var t},n.reduce((function(e,n){var r=t instanceof Function?t(n):n[t];return(e[r]=e[r]||[]).push(n),e}),{}));return Object.keys(r).map((function(e){return{time:Object(F.a)(e,"yyyy-MM-dd HH",0),temp:T(r[e].map((function(e){return e.temp}))),hum:T(r[e].map((function(e){return e.hum})))}})).reverse()}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Z="wss://paletten.oliverflecke.me:9001",$=[{id:"C4402D",name:"Spisebord"},{id:"C431FB",name:"Sofa"},{id:"10DB9C",name:"Sovev\xe6relse"}],_={qos:1};var q=function(){var e=Object(c.useState)(),t=Object(b.a)(e,2),n=t[0],a=t[1];return Object(c.useEffect)((function(){function e(){return(e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(j.connectAsync)(Z,void 0,!1);case 3:t=e.sent,a(t),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.warn(e.t0),a(null);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),void 0===n?Object(r.jsx)("h2",{className:"text-black dark:text-white w-full text-center text-xl",children:"Connecting..."}):null===n?Object(r.jsx)("h2",{className:"text-black dark:text-white w-full text-center text-xl",children:"Failed to connect. Please contact website developer"}):Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(U,{client:n}),Object(r.jsxs)("span",{className:"text-sm",children:["Version: ","1.0.0"]})]})},U=function(e){var t=e.client,n=K(),a=Object(b.a)(n,2),i=a[0],o=a[1],j=K(),f=Object(b.a)(j,2),h=f[0],m=f[1],x=Object(c.useState)((function(){return $.map((function(e){return new S(e.id,e.name,t)}))})),v=Object(b.a)(x,2),k=v[0],N=v[1];return Object(c.useEffect)((function(){function e(){return(e=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:V(t,k.map((function(e){return e.id})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}t.on("message",(function(e,t){if(e.startsWith("temperature/"))switch(Y(e)){case"inside":null===o||void 0===o||o.setTemperature(Number(t));break;case"outside":null===m||void 0===m||m.setTemperature(Number(t))}else if(e.startsWith("humidity/"))switch(Y(e)){case"inside":o.setHumidity(Number(t));break;case"outside":m.setHumidity(Number(t))}if(e.startsWith("shellies")){var n=e.match(Object(u.a)(/\x2D([0-9A-Z_a-z]*)/,{id:1}));if(null===n||void 0===n?void 0:n.groups){var r="on"===t.toString()?g.On:g.Off,c=null===n||void 0===n?void 0:n.groups.id;N((function(e){return e.map((function(e){return Object(s.a)(Object(s.a)({},e),{},{state:e.id===c?r:e.state})}))}))}}})),function(t){e.apply(this,arguments)}(t)}),[t]),Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(p,{}),Object(r.jsxs)("section",{className:"flex justify-between space-x-6 pb-4 max-w-lg w-full",children:[Object(r.jsx)(y,{name:"Inde",state:i}),Object(r.jsx)(y,{name:"Ude",state:h})]}),Object(r.jsx)("section",{className:"w-full flex flex-col justify-center align-middle",children:k.map((function(e){return Object(r.jsx)(C,{shelly:e},e.id)}))}),Object(r.jsx)(Q,{}),Object(r.jsx)(w,{shellies:k}),Object(r.jsx)(Q,{}),Object(r.jsx)(O,{client:t}),Object(r.jsx)(Q,{}),Object(r.jsx)(I,{client:t})]})};function V(e,t){t.forEach(function(){var t=Object(d.a)(l.a.mark((function t(n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.subscribe("shellies/shelly1-".concat(n,"/relay/0"),_);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),["inside","outside"].forEach(function(){var t=Object(d.a)(l.a.mark((function t(n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.subscribe("temperature/".concat(n),_);case 2:return t.next=4,e.subscribe("humidity/".concat(n),_);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}function Y(e){var t=e.match(Object(u.a)(/\/([0-9A-Z_a-z]+)$/,{place:1}));return(null===t||void 0===t?void 0:t.groups)?null===t||void 0===t?void 0:t.groups.place:void 0}function G(e){switch(e){case g.Off:return"red";case g.On:return"green";default:return"grey"}}function K(){var e=Object(c.useState)(),t=Object(b.a)(e,2),n=t[0],r=t[1],a=Object(c.useState)(),i=Object(b.a)(a,2);return[{temperature:n,humidity:i[0]},{setTemperature:r,setHumidity:i[1]}]}var Q=function(){return Object(r.jsx)("hr",{className:"w-full my-4"})},R=document.getElementById("root"),X=Object(r.jsx)(a.a.StrictMode,{children:Object(r.jsx)(q,{})});(null===R||void 0===R?void 0:R.hasChildNodes())?Object(i.hydrate)(X,R):Object(i.render)(X,R),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[227,1,2]]]);
//# sourceMappingURL=main.922f4b67.chunk.js.map